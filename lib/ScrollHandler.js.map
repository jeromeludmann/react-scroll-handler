{"version":3,"file":"ScrollHandler.js","sources":["../src/ScrollHandler.tsx"],"sourcesContent":["import React, { SyntheticEvent } from 'react'\n\nexport interface Props {\n  onTop?: (position: ScrollPosition) => void\n  onBottom?: (position: ScrollPosition) => void\n  onUp?: (position: ScrollPosition) => void\n  onDown?: (position: ScrollPosition) => void\n  topOffset?: number\n  bottomOffset?: number\n  children?: any\n}\n\nexport interface ScrollPosition {\n  scrollTop: number\n  isTop: boolean\n  isBottom: boolean\n  isUp: boolean\n  isDown: boolean\n}\n\nexport default class ScrollHandler extends React.Component<Props, {}> {\n  private scrollable: React.CSSProperties = {\n    overflowY: 'scroll',\n    height: 'inherit'\n  }\n\n  private lastScrollTop = 0\n  private currentScrollTop = 0\n\n  private position: { [key: string]: boolean } = {\n    isUp: false,\n    isDown: false,\n    isTop: true,\n    isBottom: false\n  }\n\n  private handlers: { [key: string]: (position: ScrollPosition) => void } = {\n    onUp: null,\n    onDown: null,\n    onTop: null,\n    onBottom: null\n  }\n\n  public componentDidMount() {\n    this.assignHandlers(this.props)\n  }\n\n  public componentWillUnmount() {\n    if (window.onscroll) {\n      window.onscroll = null\n    }\n  }\n\n  public componentDidUpdate() {\n    this.assignHandlers(this.props)\n  }\n\n  public render() {\n    if (!this.props.children) {\n      return <div />\n    }\n\n    return (\n      <div style={this.scrollable} onScroll={this.handleScrollEvent}>\n        {this.props.children}\n      </div>\n    )\n  }\n\n  private assignHandlers = (props: Props) => {\n    this.handlers = {\n      onUp: props.onUp,\n      onDown: props.onDown,\n      onTop: props.onTop,\n      onBottom: props.onBottom\n    }\n\n    if (props.children) {\n      window.onscroll = null\n    } else {\n      window.onscroll = () =>\n        this.handleScroll({\n          scrollTop: window.scrollY || window.pageYOffset,\n          offsetHeight: window.innerHeight,\n          scrollHeight: document.body.offsetHeight\n        })\n    }\n  }\n\n  private handleScrollEvent = (ev: SyntheticEvent<any>) => {\n    return this.handleScroll(ev.currentTarget)\n  }\n\n  private handleScroll = (scrollData: {\n    scrollTop: number\n    offsetHeight: number\n    scrollHeight: number\n  }) => {\n    this.currentScrollTop = scrollData.scrollTop\n\n    this.callHandler('Up', scrollData.scrollTop < this.lastScrollTop)\n    this.callHandler('Down', scrollData.scrollTop > this.lastScrollTop)\n    this.callHandler('Top', scrollData.scrollTop <= (this.props.topOffset || 0))\n    this.callHandler(\n      'Bottom',\n      scrollData.scrollTop + scrollData.offsetHeight >=\n        scrollData.scrollHeight - (this.props.bottomOffset || 0)\n    )\n\n    this.lastScrollTop = scrollData.scrollTop\n  }\n\n  private callHandler = (position: string, condition: boolean) => {\n    this.position[`is${position}`] = condition\n\n    if (!this.handlers[`on${position}`] || !this.position[`is${position}`]) {\n      return\n    }\n\n    return this.handlers[`on${position}`]({\n      scrollTop: this.currentScrollTop,\n      isUp: this.position.isUp,\n      isDown: this.position.isDown,\n      isTop: this.position.isTop,\n      isBottom: this.position.isBottom\n    })\n  }\n}\n"],"names":["tslib_1.__extends"],"mappings":"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"}