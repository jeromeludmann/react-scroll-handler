{"version":3,"file":"ScrollHandler.js","sources":["../src/ScrollHandler.tsx"],"sourcesContent":["import React, { SyntheticEvent } from 'react'\n\nexport interface Props {\n  onTop?: (scroll: ScrollState) => void\n  onBottom?: (scroll: ScrollState) => void\n  onUp?: (scroll: ScrollState) => void\n  onDown?: (scroll: ScrollState) => void\n  topOffset?: number\n  bottomOffset?: number\n  children?: any\n}\n\nexport interface ScrollState {\n  scrollTop: number\n  isTop: boolean\n  isBottom: boolean\n  isUp: boolean\n  isDown: boolean\n}\n\ninterface ScrollEventData {\n  scrollTop: number\n  offsetHeight: number\n  scrollHeight: number\n}\n\nexport default class ScrollHandler extends React.Component<Props, {}> {\n  private lastScrollTop = 0\n  private isTop = true\n  private isBottom = false\n  private isUp = false\n  private isDown = false\n  private wrapper: React.CSSProperties = {\n    overflowY: 'scroll',\n    height: 'inherit'\n  }\n\n  public componentDidMount() {\n    if (!this.props.children) {\n      window.onscroll = () =>\n        this.handleScroll({\n          scrollTop: window.scrollY || window.pageYOffset,\n          offsetHeight: window.innerHeight,\n          scrollHeight: document.body.offsetHeight\n        })\n    }\n  }\n\n  public render() {\n    if (!this.props.children) {\n      return <div />\n    }\n\n    return (\n      <div style={this.wrapper} onScroll={this.handleScrollEvent}>\n        {this.props.children}\n      </div>\n    )\n  }\n\n  private handleScrollEvent = (ev: SyntheticEvent<any>) => {\n    return this.handleScroll(ev.currentTarget)\n  }\n\n  private handleScroll = (scrollData: ScrollEventData) => {\n    for (const cb of [\n      this.handleScrollUp,\n      this.handleScrollDown,\n      this.handleScrollTop,\n      this.handleScrollBottom\n    ]) {\n      cb(scrollData)\n    }\n\n    this.lastScrollTop = scrollData.scrollTop\n  }\n\n  private handleScrollUp = ({ scrollTop }: ScrollEventData) => {\n    this.isUp = scrollTop < this.lastScrollTop\n\n    if (!this.props.onUp) {\n      return\n    }\n\n    if (!this.isUp) {\n      return\n    }\n\n    this.props.onUp(this.getScrollCurrentState(scrollTop))\n  }\n\n  private handleScrollDown = ({ scrollTop }: ScrollEventData) => {\n    this.isDown = scrollTop > this.lastScrollTop\n\n    if (!this.props.onDown) {\n      return\n    }\n\n    if (!this.isDown) {\n      return\n    }\n\n    this.props.onDown(this.getScrollCurrentState(scrollTop))\n  }\n\n  private handleScrollTop = ({ scrollTop }: ScrollEventData) => {\n    this.isTop = scrollTop <= (this.props.topOffset || 0)\n\n    if (!this.props.onTop) {\n      return\n    }\n\n    if (!this.isTop) {\n      return\n    }\n\n    this.props.onTop(this.getScrollCurrentState(scrollTop))\n  }\n\n  private handleScrollBottom = ({\n    scrollTop,\n    offsetHeight,\n    scrollHeight\n  }: ScrollEventData) => {\n    this.isBottom =\n      scrollTop + offsetHeight >= scrollHeight - (this.props.bottomOffset || 0)\n\n    if (!this.props.onBottom) {\n      return\n    }\n\n    if (!this.isBottom) {\n      return\n    }\n\n    this.props.onBottom(this.getScrollCurrentState(scrollTop))\n  }\n\n  private getScrollCurrentState = (scrollTop: number) => ({\n    scrollTop,\n    isTop: this.isTop,\n    isBottom: this.isBottom,\n    isUp: this.isUp,\n    isDown: this.isDown\n  })\n}\n"],"names":["tslib_1.__extends"],"mappings":"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"}